import{g as D,ah as B,a7 as F,r as S,ai as Q,j as W,S as Z,T as H,Z as X,A as u,Q as r,J as n,I as o,ac as j,K as e,B as x,V as T,W as I,L as y,ae as Y,aa as U,a9 as V,ak as ee,l as f,ab as te,a8 as z,al as ae,U as le,ad as O,ag as ne,af as se}from"./index-d3fab68d.js";import{_ as oe,b as ue,c as ie,u as re,a as pe}from"./table-fb04db72.js";import{_ as de}from"./InputNumber-eeed7fef.js";import{_ as ce}from"./Grid-a51efec6.js";import{_ as me}from"./FormItem-f5746594.js";import{_ as _e}from"./Scrollbar-3b231a05.js";const fe=D({name:"MenuOperateModal"}),ve=D({...fe,props:B({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:B(["submitted"],["update:visible"]),setup(R,{emit:C}){const p=R,h=C,m=F(),k=S(null),c=Q(R,"visible"),A=W(()=>({add:"新增菜单",addChild:"新增子菜单",edit:"编辑菜单"})[p.operateType]);function w(){c.value=!1}const a=Z(v());function v(){return{permission:"",name:"",parentId:-1,icon:"",sort:0,type:"0",path:"",keepAlive:"0",disableMenu:"0",display:"0",systemMenu:"0"}}const _={name:{required:!0,trigger:["blur","input"],message:"请输入标题"},type:{required:!0,trigger:"change",message:"请选择类型"}};function g(){if(console.log(111),Object.assign(a,v()),!!p.rowData){if(p.operateType==="addChild"){const{id:s}=p.rowData;Object.assign(a,{parentId:s})}p.operateType==="edit"&&Object.assign(a,p.rowData,{menuId:p.rowData.id})}}async function M(){var s;(s=k.value)==null||s.validate(async l=>{l||(p.operateType==="add"||p.operateType==="addChild"?await m.addSystemMenu(a):await m.putSystemMenu(a),w(),h("submitted"))})}return H(c,()=>{var s;c.value&&(g(),(s=k.value)==null||s.restoreValidation())}),(s,l)=>{const N=Y,d=oe,b=ue,i=ie,q=X("SelectIcons"),G=de,K=ce,P=me,L=_e,$=U,E=V,J=ee;return u(),r(J,{show:c.value,"onUpdate:show":l[9]||(l[9]=t=>c.value=t),title:e(A),preset:"card",class:"w-800px"},{footer:n(()=>[o(E,{justify:"end",size:16},{default:n(()=>[o($,{onClick:w},{default:n(()=>[j("取消")]),_:1}),o($,{type:"primary",onClick:M},{default:n(()=>[j(" 确认 ")]),_:1})]),_:1})]),default:n(()=>[o(L,{class:"h-480px pr-20px"},{default:n(()=>[o(P,{ref_key:"formRef",ref:k,model:e(a),rules:_,"label-placement":"left","label-width":100},{default:n(()=>[o(K,{responsive:"screen","item-responsive":""},{default:n(()=>[o(d,{span:"24 m:24",label:"标题",path:"name"},{default:n(()=>[o(N,{value:e(a).name,"onUpdate:value":l[0]||(l[0]=t=>e(a).name=t),placeholder:"请输入标题"},null,8,["value"])]),_:1}),o(d,{span:"24 m:24",label:"类型",path:"type"},{default:n(()=>[o(i,{value:e(a).type,"onUpdate:value":l[1]||(l[1]=t=>e(a).type=t)},{default:n(()=>[(u(!0),x(T,null,I(e(m).menuTypeOptions,t=>(u(),r(b,{key:t.value,value:t.value,label:t.label},null,8,["value","label"]))),128))]),_:1},8,["value"])]),_:1}),e(a).type==="0"?(u(),r(d,{key:0,span:"24 m:24",label:"地址",path:"path",rule:{required:!0,message:"请输入地址",trigger:["input","blur"]}},{default:n(()=>[o(N,{value:e(a).path,"onUpdate:value":l[2]||(l[2]=t=>e(a).path=t),placeholder:"请输入地址"},null,8,["value"])]),_:1})):y("",!0),e(a).type==="0"?(u(),r(d,{key:1,span:"24 m:24",label:"图标",path:"icon"},{default:n(()=>[o(q,{selected:e(a).icon,"onUpdate:selected":l[3]||(l[3]=t=>e(a).icon=t),class:"w-full"},null,8,["selected"])]),_:1})):y("",!0),e(a).type==="0"?(u(),r(d,{key:2,span:"24 m:24",label:"排序",path:"sort"},{default:n(()=>[o(G,{value:e(a).sort,"onUpdate:value":l[4]||(l[4]=t=>e(a).sort=t),class:"w-full",clearable:"",placeholder:"请输入菜单顺序"},null,8,["value"])]),_:1})):y("",!0),e(a).type==="0"?(u(),r(d,{key:3,span:"24 m:12",label:"路由缓存",path:"keepAlive"},{default:n(()=>[o(i,{value:e(a).keepAlive,"onUpdate:value":l[5]||(l[5]=t=>e(a).keepAlive=t)},{default:n(()=>[(u(!0),x(T,null,I(e(m).switchOptions,t=>(u(),r(b,{key:t.value,value:t.value,label:t.label},null,8,["value","label"]))),128))]),_:1},8,["value"])]),_:1})):y("",!0),e(a).type==="0"?(u(),r(d,{key:4,span:"24 m:12",label:"是否启用",path:"disableMenu"},{default:n(()=>[o(i,{value:e(a).disableMenu,"onUpdate:value":l[6]||(l[6]=t=>e(a).disableMenu=t)},{default:n(()=>[(u(!0),x(T,null,I(e(m).switchOptions,t=>(u(),r(b,{key:t.value,value:t.value,label:t.label},null,8,["value","label"]))),128))]),_:1},8,["value"])]),_:1})):y("",!0),e(a).type==="0"?(u(),r(d,{key:5,span:"24 m:12",label:"自动展开",path:"display"},{default:n(()=>[o(i,{value:e(a).display,"onUpdate:value":l[7]||(l[7]=t=>e(a).display=t)},{default:n(()=>[(u(!0),x(T,null,I(e(m).switchOptions,t=>(u(),r(b,{key:t.value,value:t.value,label:t.label},null,8,["value","label"]))),128))]),_:1},8,["value"])]),_:1})):y("",!0),e(a).type==="1"?(u(),r(d,{key:6,span:"24 m:24",label:"权限标识",path:"permission",rule:{required:!0,message:"请输入权限标识",trigger:["input","blur"]}},{default:n(()=>[o(N,{value:e(a).permission,"onUpdate:value":l[8]||(l[8]=t=>e(a).permission=t),placeholder:"请输入权限标识"},null,8,["value"])]),_:1})):y("",!0)]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["show","title"])}}}),ye={class:"flex-vertical-stretch gap-16px overflow-hidden <sm:overflow-auto"},ge=D({name:"SystemManagementMenu"}),Se=D({...ge,setup(R){const C=F(),p=()=>{g.value="add",_.value=!0},h=S([]),m=async s=>{await C.delSystemMenu(s.id),v()},{columns:k,columnChecks:c,data:A,loading:w,pagination:a,getData:v}=re({apiFn:C.getSystemMenuTree,apiParams:{},columns:()=>[{key:"id",title:"ID",width:100,align:"left"},{key:"parentId",title:"父节点ID",width:100,align:"center"},{key:"name",title:"标题",width:120,align:"center"},{key:"path",title:"地址",width:150,align:"center"},{key:"icon",title:"图标",width:60,align:"center",render:s=>f(te,{class:"text-22px",icon:s.icon})},{key:"sort",title:"排序",width:60,align:"center"},{key:"type",title:"类型",width:60,render:s=>f(z,{type:s.type==="0"?"primary":"success"},{default:()=>s.type==="0"?"菜单":"按钮"})},{key:"disableMenu",title:"是否启用",width:60,align:"center",render:()=>f(z,{type:"success"},{default:()=>"是"})},{key:"active",title:"操作",width:180,align:"center",render:s=>f(V,{justify:"center"},{default:()=>[f(U,{size:"small",type:"primary",ghost:!0,onClick:()=>{g.value="addChild",M.value={...s},_.value=!0}},{default:()=>"新增子菜单"}),f(U,{size:"small",type:"primary",ghost:!0,onClick:()=>{g.value="edit",M.value={...s},_.value=!0}},{default:()=>"编辑"}),f(ae,{onPositiveClick:()=>m(s)},{default:()=>"确认删除吗？",trigger:()=>f(U,{size:"small",type:"error",ghost:!0},{default:()=>"删除"})})]})}],immediate:void 0}),_=S(!1),g=S("add"),M=S(void 0);return le(async()=>{await v()}),(s,l)=>{const N=ne,d=pe,b=se;return u(),x("div",ye,[o(b,{title:"菜单管理",bordered:!1,size:"small",class:"card-wrapper sm:flex-1-hidden"},{"header-extra":n(()=>[o(N,{columns:e(c),"onUpdate:columns":l[0]||(l[0]=i=>O(c)?c.value=i:null),"is-delete-btn":!1,loading:e(w),onAdd:p,onRefresh:e(v)},null,8,["columns","loading","onRefresh"])]),default:n(()=>[o(d,{"checked-row-keys":e(h),"onUpdate:checkedRowKeys":l[1]||(l[1]=i=>O(h)?h.value=i:null),columns:e(k),data:e(A),size:"small","flex-height":!0,"scroll-x":640,loading:e(w),pagination:e(a),"row-key":i=>i.id,class:"sm:h-full"},null,8,["checked-row-keys","columns","data","loading","pagination","row-key"]),o(ve,{visible:e(_),"onUpdate:visible":l[2]||(l[2]=i=>O(_)?_.value=i:null),"operate-type":e(g),"row-data":e(M),onSubmitted:e(v)},null,8,["visible","operate-type","row-data","onSubmitted"])]),_:1})])}}});export{Se as default};
