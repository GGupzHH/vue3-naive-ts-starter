import{g as C,ah as U,a7 as I,r as b,ai as K,j as P,S as V,T as q,A as O,Q as G,J as o,I as t,ac as z,K as e,ae as E,aj as J,aa as N,a9 as B,ak as L,l as h,al as Q,U as H,B as W,ad as x,ag as X,af as Y}from"./index-33ab4936.js";import{_ as Z,u as ee,a as ae}from"./table-cac2e23c.js";import{u as te,a as ne}from"./dictTag-11fb898c.js";import{_ as le}from"./InputNumber-6a8a6f00.js";import{_ as oe}from"./Scrollbar-4e93fcfb.js";import{_ as se}from"./Grid-6b808ad5.js";import{_ as ie}from"./FormItem-a98b5015.js";const re=C({name:"OrganizationalOperateModal"}),de=C({...re,props:U({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:U(["submitted"],["update:visible"]),setup(S,{emit:w}){const i=S,f=w,k=I(),g=b(null),d=K(S,"visible"),T=P(()=>({add:"新增组织",addChild:"新增子组织",edit:"编辑组织"})[i.operateType]);function v(){d.value=!1}const n=V(c());function c(){return{name:"",sort:0,departCode:"",parentId:0,parentCode:"",nickName:"",type:"0",percharge:"",phone:"",address:""}}const p={name:{required:!0,trigger:["blur","input"],message:"请输入名称"},nickName:{required:!0,trigger:["blur","input"],message:"请输入简称"}};function _(){var l;Object.assign(n,c()),i.rowData&&i.operateType==="edit"&&Object.assign(n,i.rowData,{orgId:(l=i.rowData)==null?void 0:l.id})}async function y(){var l;(l=g.value)==null||l.validate(async a=>{a||(console.log(n),i.operateType==="add"||i.operateType==="addChild"?await k.addSystemOrganizational(n):await k.putSystemOrganizational(n),v(),f("submitted"))})}return q(d,()=>{var l,a;d.value&&(_(),i.operateType==="addChild"&&(n.parentId=(l=i.rowData)==null?void 0:l.id),(a=g.value)==null||a.restoreValidation())}),(l,a)=>{const m=E,r=Z,D=J,u=le,R=se,$=ie,j=oe,M=N,A=B,F=L;return O(),G(F,{show:d.value,"onUpdate:show":a[8]||(a[8]=s=>d.value=s),title:e(T),preset:"card",class:"w-800px"},{footer:o(()=>[t(A,{justify:"end",size:16},{default:o(()=>[t(M,{onClick:v},{default:o(()=>[z("取消")]),_:1}),t(M,{type:"primary",onClick:y},{default:o(()=>[z(" 确认 ")]),_:1})]),_:1})]),default:o(()=>[t(j,{class:"h-240px pr-20px"},{default:o(()=>[t($,{ref_key:"formRef",ref:g,model:e(n),rules:p,"label-placement":"left","label-width":100},{default:o(()=>[t(R,{responsive:"screen","item-responsive":""},{default:o(()=>[t(r,{span:"24 m:12",label:"名称",path:"name"},{default:o(()=>[t(m,{value:e(n).name,"onUpdate:value":a[0]||(a[0]=s=>e(n).name=s),placeholder:"请输入名称"},null,8,["value"])]),_:1}),t(r,{span:"24 m:12",label:"简称",path:"nickName"},{default:o(()=>[t(m,{value:e(n).nickName,"onUpdate:value":a[1]||(a[1]=s=>e(n).nickName=s),placeholder:"请输入简称"},null,8,["value"])]),_:1}),t(r,{span:"24 m:12",label:"编码",path:"departCode"},{default:o(()=>[t(m,{value:e(n).departCode,"onUpdate:value":a[2]||(a[2]=s=>e(n).departCode=s),placeholder:"请输入编码"},null,8,["value"])]),_:1}),t(r,{span:"24 m:12",label:"组织类型",path:"dsType"},{default:o(()=>[t(D,{value:e(n).type,"onUpdate:value":a[3]||(a[3]=s=>e(n).type=s),options:e(te)("org_type"),placeholder:"请选择组织类型"},null,8,["value","options"])]),_:1}),t(r,{span:"24 m:12",label:"排序",path:"sort"},{default:o(()=>[t(u,{value:e(n).sort,"onUpdate:value":a[4]||(a[4]=s=>e(n).sort=s),class:"w-full",clearable:"",placeholder:"请输入菜单顺序"},null,8,["value"])]),_:1}),t(r,{span:"24 m:12",label:"联系人",path:"percharge"},{default:o(()=>[t(m,{value:e(n).percharge,"onUpdate:value":a[5]||(a[5]=s=>e(n).percharge=s),placeholder:"请输入联系人"},null,8,["value"])]),_:1}),t(r,{span:"24 m:12",label:"联系方式",path:"phone"},{default:o(()=>[t(m,{value:e(n).phone,"onUpdate:value":a[6]||(a[6]=s=>e(n).phone=s),placeholder:"请输入联系方式"},null,8,["value"])]),_:1}),t(r,{span:"24 m:12",label:"联系地址",path:"address"},{default:o(()=>[t(m,{value:e(n).address,"onUpdate:value":a[7]||(a[7]=s=>e(n).address=s),placeholder:"请输入联系地址"},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["show","title"])}}}),ue={class:"flex-vertical-stretch gap-16px overflow-hidden <sm:overflow-auto"},pe=C({name:"SystemManagementOrganizational"}),he=C({...pe,setup(S){const w=I(),i=()=>{_.value="add",p.value=!0},f=b([]),k=async l=>{await w.delSystemOrganizational(l.id),c()},{columns:g,columnChecks:d,data:T,loading:v,pagination:n,getData:c}=ee({apiFn:w.getSystemOrganizationalTree,apiParams:{},columns:()=>[{key:"id",title:"ID",width:120,align:"left"},{key:"parentId",title:"父节点ID",width:120,align:"center"},{key:"name",title:"名称",width:120,align:"center"},{key:"nickName",title:"简称",width:120,align:"center"},{key:"departCode",title:"编码",width:120,align:"center"},{key:"type",title:"类型",width:120,align:"center",render:l=>ne("org_type",l.type)},{key:"percharge",title:"联系人",width:120,align:"center"},{key:"phone",title:"联系方式",width:120,align:"center"},{key:"active",title:"操作",width:180,align:"center",render:l=>h(B,{justify:"center"},{default:()=>[h(N,{size:"small",type:"primary",ghost:!0,onClick:()=>{_.value="addChild",y.value={...l},p.value=!0}},{default:()=>"新增子机构"}),h(N,{size:"small",type:"primary",ghost:!0,onClick:()=>{_.value="edit",y.value={...l},p.value=!0}},{default:()=>"编辑"}),h(Q,{onPositiveClick:()=>k(l)},{default:()=>"确认删除吗？",trigger:()=>h(N,{size:"small",type:"error",ghost:!0},{default:()=>"删除"})})]})}],immediate:void 0}),p=b(!1),_=b("add"),y=b(void 0);return H(async()=>{await c()}),(l,a)=>{const m=X,r=ae,D=Y;return O(),W("div",ue,[t(D,{title:"组织机构管理",bordered:!1,size:"small",class:"card-wrapper sm:flex-1-hidden"},{"header-extra":o(()=>[t(m,{columns:e(d),"onUpdate:columns":a[0]||(a[0]=u=>x(d)?d.value=u:null),"is-delete-btn":!1,loading:e(v),onAdd:i,onRefresh:e(c)},null,8,["columns","loading","onRefresh"])]),default:o(()=>[t(r,{"checked-row-keys":e(f),"onUpdate:checkedRowKeys":a[1]||(a[1]=u=>x(f)?f.value=u:null),columns:e(g),data:e(T),size:"small","flex-height":!0,"scroll-x":640,loading:e(v),pagination:e(n),"row-key":u=>u.id,class:"sm:h-full"},null,8,["checked-row-keys","columns","data","loading","pagination","row-key"]),t(de,{visible:e(p),"onUpdate:visible":a[2]||(a[2]=u=>x(p)?p.value=u:null),"operate-type":e(_),"row-data":e(y),onSubmitted:e(c)},null,8,["visible","operate-type","row-data","onSubmitted"])]),_:1})])}}});export{he as default};
